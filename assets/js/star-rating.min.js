!function(l){"use strict";String.prototype.replaceAll=function(t,e){return this.split(t).join(e)};var s=function(t,e){return null==t||0===t.length||e&&""===l.trim(t)},o=function(t,e){t.removeClass(e).addClass(e)},c=function(t,e,a){var n=s(t.data(e))?t.attr(e):t.data(e);return n||a[e]},i=function(t,e){this.$element=l(t),this.init(e)};i.prototype={constructor:i,_parseAttr:function(t,e){var a=this.$element;if("range"!==a.attr("type")&&"number"!==a.attr("type"))return parseFloat(e[t]);var n,r,i=c(a,t,e);switch(t){case"min":n=0;break;case"max":n=5;break;default:n=.5}return r=s(i)?n:i,parseFloat(r)},listenClick:function(t,e){t.on("click touchstart",function(t){if(t.stopPropagation(),t.preventDefault(),!0===t.handled)return!1;e(t),t.handled=!0})},setDefault:function(t,e){s(this[t])&&(this[t]=e)},getPosition:function(t){return(t.pageX||t.originalEvent.touches[0].pageX)-this.$rating.offset().left},listen:function(){var e,n,r=this;r.initTouch(),r.listenClick(r.$rating,function(t){if(r.inactive)return!1;e=r.getPosition(t),r.setStars(e),r.$element.trigger("change").trigger("rating.change",[r.$element.val(),r.$caption.html()]),r.starClicked=!0}),r.$rating.on("mousemove",function(t){r.hoverEnabled&&!r.inactive&&(r.starClicked=!1,e=r.getPosition(t),n=r.calculate(e),r.toggleHover(n),r.$element.trigger("rating.hover",[n.val,n.caption,"stars"]))}),r.$rating.on("mouseleave",function(){!r.hoverEnabled||r.inactive||r.starClicked||(n=r.cache,r.toggleHover(n),r.$element.trigger("rating.hoverleave",["stars"]))}),r.$clear.on("mousemove",function(){if(r.hoverEnabled&&!r.inactive&&r.hoverOnClear){r.clearClicked=!1;var t='<span class="'+r.clearCaptionClass+'">'+r.clearCaption+"</span>",e=r.clearValue,a=r.getWidthFromValue(e);n={caption:t,width:a,val:e},r.toggleHover(n),r.$element.trigger("rating.hover",[e,t,"clear"])}}),r.$clear.on("mouseleave",function(){r.hoverEnabled&&!r.inactive&&!r.clearClicked&&r.hoverOnClear&&(n=r.cache,r.toggleHover(n),r.$element.trigger("rating.hoverleave",["clear"]))}),r.listenClick(r.$clear,function(){r.inactive||(r.clear(),r.clearClicked=!0)}),l(r.$element[0].form).on("reset",function(){r.inactive||r.reset()})},destroy:function(){var t=this,e=t.$element;s(t.$container)||t.$container.before(e).remove(),l.removeData(e.get(0)),e.off("rating").removeClass("hide")},create:function(t){var e=this,a=e.$element;t=t||e.options||{},e.destroy(),a.rating(t)},setTouch:function(t,e){var a=this;if(("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)&&!a.inactive){var n=t.originalEvent,r=n.touches||n.changedTouches,i=a.getPosition(r[0]);if(e)a.setStars(i),a.$element.trigger("change").trigger("rating.change",[a.$element.val(),a.$caption.html()]),a.starClicked=!0;else{var l=a.calculate(i),o=l.val<=a.clearValue?a.fetchCaption(a.clearValue):l.caption,s=a.getWidthFromValue(a.clearValue),c=l.val<=a.clearValue?a.rtl?100-s+"%":s+"%":l.width;a.$caption.html(o),a.$stars.css("width",c)}}},initTouch:function(){var a=this;a.$rating.on("touchstart touchmove touchend",function(t){var e="touchend"===t.type;a.setTouch(t,e)})},initSlider:function(t){var e=this;s(e.$element.val())&&e.$element.val(0),e.initialValue=e.$element.val(),e.setDefault("min",e._parseAttr("min",t)),e.setDefault("max",e._parseAttr("max",t)),e.setDefault("step",e._parseAttr("step",t)),(isNaN(e.min)||s(e.min))&&(e.min=0),(isNaN(e.max)||s(e.max))&&(e.max=5),(isNaN(e.step)||s(e.step)||0===e.step)&&(e.step=.5),e.diff=e.max-e.min},init:function(t){var e,a,n,r=this,i=r.$element;r.options=t,l.each(t,function(t,e){r[t]=e}),r.starClicked=!1,r.clearClicked=!1,r.initSlider(t),r.checkDisabled(),r.setDefault("rtl",i.attr("dir")),r.rtl&&i.attr("dir","rtl"),e=r.glyphicon?"":"★",r.setDefault("symbol",e),r.setDefault("clearButtonBaseClass","clear-rating"),r.setDefault("clearButtonActiveClass","clear-rating-active"),r.setDefault("clearValue",r.min),o(i,"form-control hide"),r.$clearElement=s(t.clearElement)?null:l(t.clearElement),r.$captionElement=s(t.captionElement)?null:l(t.captionElement),void 0===r.$rating&&void 0===r.$container&&(r.$rating=l(document.createElement("div")).html('<div class="rating-stars"></div>'),r.$container=l(document.createElement("div")),r.$container.before(r.$rating).append(r.$rating),i.before(r.$container).appendTo(r.$rating)),r.$stars=r.$rating.find(".rating-stars"),r.generateRating(),r.$clear=s(r.$clearElement)?r.$container.find("."+r.clearButtonBaseClass):r.$clearElement,r.$caption=s(r.$captionElement)?r.$container.find(".caption"):r.$captionElement,r.setStars(),r.listen(),r.showClear&&r.$clear.attr({class:r.getClearClass()}),a=i.val(),n=r.getWidthFromValue(a),r.cache={caption:r.$caption.html(),width:(r.rtl?100-n:n)+"%",val:a},i.removeClass("rating-loading")},checkDisabled:function(){var t=this;t.disabled=c(t.$element,"disabled",t.options),t.readonly=c(t.$element,"readonly",t.options),t.inactive=t.disabled||t.readonly},getClearClass:function(){return this.clearButtonBaseClass+" "+(this.inactive?"":this.clearButtonActiveClass)},generateRating:function(){var t=this,e=t.renderClear(),a=t.renderCaption(),n=t.rtl?"rating-container-rtl":"rating-container",r=t.getStars();t.glyphicon?n+=(""===t.symbol?" rating-gly-star":" rating-gly")+t.ratingClass:n+=s(t.ratingClass)?" rating-uni":" "+t.ratingClass,t.$rating.attr("class",n),t.$rating.attr("data-content",r),t.$stars.attr("data-content",r),n=t.rtl?"star-rating-rtl":"star-rating",t.$container.attr("class",n+" rating-"+t.size),t.$container.removeClass("rating-active rating-disabled"),t.inactive?t.$container.addClass("rating-disabled"):t.$container.addClass("rating-active"),s(t.$caption)&&(t.rtl?t.$container.prepend(a):t.$container.append(a)),s(t.$clear)&&(t.rtl?t.$container.append(e):t.$container.prepend(e)),s(t.containerClass)||o(t.$container,t.containerClass)},getStars:function(){var t,e=this.stars,a="";for(t=1;t<=e;t++)a+=this.symbol;return a},renderClear:function(){var t,e=this;return e.showClear?(t=e.getClearClass(),s(e.$clearElement)?'<div class="'+t+'" title="'+e.clearButtonTitle+'">'+e.clearButton+"</div>":(o(e.$clearElement,t),e.$clearElement.attr({title:e.clearButtonTitle}).html(e.clearButton),"")):""},renderCaption:function(){var t,e=this,a=e.$element.val();return e.showCaption?(t=e.fetchCaption(a),s(e.$captionElement)?'<div class="caption">'+t+"</div>":(o(e.$captionElement,"caption"),e.$captionElement.attr({title:e.clearCaption}).html(t),"")):""},fetchCaption:function(t){var e,a,n,r=this,i=parseFloat(t),l=r.starCaptions,o=r.starCaptionClasses;return n="function"==typeof o?o(i):o[i],a="function"==typeof l?l(i):l[i],e=s(a)?r.defaultCaption.replaceAll("{rating}",i):a,'<span class="'+(s(n)?r.clearCaptionClass:n)+'">'+(i===r.clearValue?r.clearCaption:e)+"</span>"},getWidthFromValue:function(t){var e=this.min,a=this.max;return t<=e||e===a?0:a<=t?100:100*(t-e)/(a-e)},getValueFromPosition:function(t){var e,a,n,r,i,l,o=this,s=(n=o.step,(r=(""+n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(r[1]?r[1].length:0)-(r[2]?+r[2]:0)):0),c=o.$rating.width();return a=o.diff*t/(c*o.step),a=o.rtl?Math.floor(a):Math.ceil(a),i=parseFloat(o.min+a*o.step),l=s,e=parseFloat(i.toFixed(l)),e=Math.max(Math.min(e,o.max),o.min),o.rtl?o.max-e:e},toggleHover:function(t){var e,a,n,r=this;r.hoverChangeCaption&&(n=t.val<=r.clearValue?r.fetchCaption(r.clearValue):t.caption,r.$caption.html(n)),r.hoverChangeStars&&(e=r.getWidthFromValue(r.clearValue),a=t.val<=r.clearValue?r.rtl?100-e+"%":e+"%":t.width,r.$stars.css("width",a))},calculate:function(t){var e=this,a=s(e.$element.val())?0:e.$element.val(),n=arguments.length?e.getValueFromPosition(t):a,r=e.fetchCaption(n),i=e.getWidthFromValue(n);return e.rtl&&(i=100-i),{caption:r,width:i+="%",val:n}},setStars:function(t){var e=this,a=arguments.length?e.calculate(t):e.calculate();e.$element.val(a.val),e.$stars.css("width",a.width),e.$caption.html(a.caption),e.cache=a},clear:function(){var t=this,e='<span class="'+t.clearCaptionClass+'">'+t.clearCaption+"</span>";t.$stars.removeClass("rated"),t.inactive||t.$caption.html(e),t.$element.val(t.clearValue),t.setStars(),t.$element.trigger("rating.clear")},reset:function(){this.$element.val(this.initialValue),this.setStars(),this.$element.trigger("rating.reset")},update:function(t){arguments.length&&(this.$element.val(t),this.setStars())},refresh:function(t){var e=this;arguments.length&&(e.$rating.off("rating"),void 0!==e.$clear&&e.$clear.off(),e.init(l.extend(e.options,t)),e.showClear?e.$clear.show():e.$clear.hide(),e.showCaption?e.$caption.show():e.$caption.hide(),e.$element.trigger("rating.refresh"))}},l.fn.rating=function(n){var r=Array.apply(null,arguments);return r.shift(),this.each(function(){var t=l(this),e=t.data("rating"),a="object"==typeof n&&n;e||t.data("rating",e=new i(this,l.extend({},l.fn.rating.defaults,a,l(this).data()))),"string"==typeof n&&e[n].apply(e,r)})},l.fn.rating.defaults={stars:5,glyphicon:!1,symbol:null,ratingClass:"",disabled:!1,readonly:!1,rtl:!1,size:"md",showClear:!0,showCaption:!0,defaultCaption:"{rating} Stars",starCaptions:{.5:"Half Star",1:"One Star",1.5:"One & Half Star",2:"Two Stars",2.5:"Two & Half Stars",3:"Three Stars",3.5:"Three & Half Stars",4:"Four Stars",4.5:"Four & Half Stars",5:"Five Stars"},starCaptionClasses:{.5:"label label-danger",1:"label label-danger",1.5:"label label-warning",2:"label label-warning",2.5:"label label-info",3:"label label-info",3.5:"label label-primary",4:"label label-primary",4.5:"label label-success",5:"label label-success"},clearButton:'<i class="glyphicon glyphicon-minus-sign"></i>',clearButtonTitle:"Clear",clearButtonBaseClass:"clear-rating",clearButtonActiveClass:"clear-rating-active",clearCaption:"Not Rated",clearCaptionClass:"label label-default",clearValue:null,captionElement:null,clearElement:null,containerClass:null,hoverEnabled:!0,hoverChangeCaption:!0,hoverChangeStars:!0,hoverOnClear:!0},l.fn.rating.Constructor=i,l("input.rating").addClass("rating-loading"),l(document).ready(function(){var t=l("input.rating");0<Object.keys(t).length&&t.rating()})}(window.jQuery);