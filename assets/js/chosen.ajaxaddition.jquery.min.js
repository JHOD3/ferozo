!function(e){"use strict";var t=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=e<0?this.length+e:e,this.push.apply(this,n)};e.fn.ajaxChosen=function(n,i,h){function s(t){var h=e(this),s=h.val();return!("paste"===t.type&&h.is(":not(:focus)")||t.which&&(9===t.which||13===t.which||16===t.which||17===t.which||18===t.which||19===t.which||20===t.which||27===t.which||33===t.which||34===t.which||35===t.which||36===t.which||37===t.which||38===t.which||39===t.which||40===t.which||44===t.which||45===t.which||144===t.which||145===t.which||91===t.which||93===t.which||224===t.which||t.which>=112&&t.which<=123))&&(!("useAjax"in i&&e.isFunction(i.useAjax)&&!i.useAjax(t))&&(e(".no-results",a).hide(),e.trim(s).length<w?(o.get(0).style.background=u,p&&clearTimeout(p),!1):(g=!0,e.isArray(n.data)?("q"===n.data[n.data.length-1].name&&n.data.pop(),n.data=n.data.concat({name:"q",value:s})):("data"in n||(n.data={}),e.extend(n.data,{data:{q:s}})),"generateUrl"in i&&e.isFunction(i.generateUrl)&&(n.url=i.generateUrl(s)),o.get(0).style.background='transparent url("'+f+'") no-repeat right 3px',p&&clearTimeout(p),void(p=setTimeout(function(){d.push(s),g=!1,e.ajax(n)},700)))))}var a,c,o,u,r,l=e(this),p=!1,d=[],g=!1,f="/loading.gif",w=1;return 0===e("option",l).length&&l.append('<option value=""></option>'),h?l.chosen(h):l.chosen(),a=l.next(),o=e("input",a),u=o.get(0)?o.get(0).style.background:"","success"in n&&e.isFunction(n.success)&&(r=n.success),n.success=function(n,h,s){var p,f,v=n,m={},y=d.length,x=!1,b=!1,T=!1,k="";if(g)return d.shift(),!1;if(y>1){if(e.each(d,function(e,i){if(n.q===i)return e!==y-1?(x=!0,t.call(d,e)):(b=!0,d.length=0),!1}),x||!b)return!1}else if("undefined"==typeof d.shift())return!1;if(k=e.trim(o.val()),T=k.length<w,"processItems"in i&&e.isFunction(i.processItems))v=i.processItems(n);else{if(!("results"in v))return console.log("Expected results key in data, but was not found. Options could not be built"),!1;v=v.results}p=e("option:selected",l).not(":empty").clone().attr("selected",!0),f=e.isArray(l.val())?l.val():[l.val()],e.each(f,function(e,t){m[t]=1}),e("option",l).remove(),e('<option value=""/>').appendTo(l),p.appendTo(l),T||(e.isArray(v)?e.each(v,function(t,n){"undefined"==typeof m[n.id]&&e('<option value="'+n.id+'">'+n.text+"</option>").appendTo(l)}):e.each(v,function(t,n){"undefined"==typeof m[t]&&e('<option value="'+t+'">'+n+"</option>").appendTo(l)})),l.trigger("chosen:updated"),c=e.Event("keyup"),c.which=39,o.val(T?k:n.q).trigger(c).get(0).style.background=u,v.length>0?e(".no-results",a).hide():e(".no-results",a).show(),r&&r(n,h,s)},i||(i={}),"loadingImg"in i&&(f=i.loadingImg),"minLength"in i&&(w=i.minLength),e(".chosen-search > input, .chosen-choices .search-field input",a).bind("keyup",s).bind("paste",function(e){var t=this;setTimeout(function(){s.call(t,e)},50)}),l}}(jQuery);